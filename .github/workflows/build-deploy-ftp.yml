name: Build and Deploy Angular Project

on:
  push:
    branches:
      - main  # Ou a branch que você deseja monitorar para o deploy
  pull_request:
    branches:
      - main  # Ou a branch para a qual você deseja enviar PRs

jobs:
  build_and_deploy:
    runs-on: ubuntu-latest  # Ambiente de execução (Ubuntu)

    steps:
    - name: Check out code
      uses: actions/checkout@v3  # Faz o checkout do código

    - name: Set up Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '18.19.0'  # Definindo a versão do Node.js para v18.19 ou superior

    - name: Install dependencies
      run: npm install  # Instala as dependências do projeto

    - name: Build Angular project
      run: npm run build --if-present  # Executa o build do Angular

    - name: FTP Deploy Locaweb
      uses: locaweb/ftp-deploy@1.0.0
      with:
        host: ${{ secrets.HOST }}
        user: ${{ secrets.USER }}
        password: ${{ secrets.PASS }}
        localDir: "docs/browser"  # Atualize com o nome correto da pasta gerada pelo build
